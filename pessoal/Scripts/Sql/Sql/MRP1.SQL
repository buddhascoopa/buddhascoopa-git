DELETE PLAN_TABLE WHERE STATEMENT_ID='MRP';                                   
COMMIT;                                                                         
EXPLAIN PLAN SET STATEMENT_ID='MRP' INTO PLAN_TABLE FOR                       
INSERT INTO WIP_JOB_SCHEDULE_INTERFACE
(LAST_UPDATE_DATE,
 LAST_UPDATED_BY,
 LAST_UPDATE_LOGIN,
 CREATION_DATE,
 CREATED_BY,
 GROUP_ID,
 SOURCE_CODE,
 SOURCE_LINE_ID,
 PROCESS_TYPE,
 ORGANIZATION_ID,
 LOAD_TYPE,
 STATUS_TYPE,
 LAST_UNIT_COMPLETION_DATE,
 BOM_REVISION_DATE,
 ROUTING_REVISION_DATE,
 PRIMARY_ITEM_ID,
 CLASS_CODE,
 JOB_NAME,
 FIRM_PLANNED_FLAG,
 START_QUANTITY,
 DEMAND_CLASS )
SELECT SYSDATE,
       :b1,
       MWQ.LAST_UPDATE_LOGIN,SYSDATE,
       :b1,
       :b3,
       'MRP',
       MWQ.TRANSACTION_ID,
       2,
       :b4,
       1,
       MWQ.STATUS_CODE,
       MWQ.IMPLEMENT_DATE,
       GREATEST(:b5,CAL2.CALENDAR_DATE),
       GREATEST(:b5,CAL2.CALENDAR_DATE),
       MWQ.INVENTORY_ITEM_ID,
       MWQ.WIP_CLASS_CODE,
       MWQ.DISPOSITION,
       MWQ.FIRM_PLANNED_TYPE,
       MWQ.IMPLEMENT_QUANTITY,
       MWQ.DEMAND_CLASS 
FROM MRP_WORKBENCH_QUERY MWQ,
     MRP_SYSTEM_ITEMS MSI,
     BOM_CALENDAR_DATES CAL1,
     BOM_CALENDAR_DATES CAL2 
WHERE MWQ.QUERY_ID = :b7 
  AND MWQ.IMPLEMENT_QUANTITY > 0
  AND MWQ.LOAD_TYPE = :b8 
  AND MSI.ORGANIZATION_ID = MWQ.ORGANIZATION_ID
  AND MSI.INVENTORY_ITEM_ID = MWQ.INVENTORY_ITEM_ID
  AND MSI.COMPILE_DESIGNATOR = :b9 
  AND CAL2.SEQ_NUM = NVL(CAL1.SEQ_NUM,CAL1.PRIOR_SEQ_NUM) - CEIL(NVL(MSI.FIXED_LEAD_TIME,0) + (MWQ.IMPLEMENT_QUANTITY * NVL(MSI.VARIABLE_LEAD_TIME,0) ) )
  AND CAL2.EXCEPTION_SET_ID = CAL1.EXCEPTION_SET_ID 
  AND CAL2.CALENDAR_CODE = CAL1.CALENDAR_CODE 
  AND CAL1.CALENDAR_DATE = MWQ.IMPLEMENT_DATE                      
  AND CAL1.CALENDAR_CODE = :b11 
  AND CAL1.EXCEPTION_SET_ID = :b10 
/
col options for a15
col operation for a30
select lpad('.',2*(level-1))||operation operation,options,object_name
from plan_table
start with id = 0 and statement_id = 'MRP'
connect by prior  id = parent_id and statement_id = 'MRP'
/
